<form [formGroup]="form" (ngSubmit)="onSubmit()" class="flex flex-col gap-4">
  <!-- Row 1: Description & Date -->
  <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
    <mat-form-field appearance="outline" class="w-full">
      <mat-label>{{ "transaction.description" | translate }}</mat-label>
      <input
        matInput
        formControlName="description"
        placeholder="{{ 'transaction.description-placeholder' | translate }} "
      />
      <app-input-error [control]="form.controls.description"></app-input-error>
    </mat-form-field>

    <mat-form-field appearance="outline" class="w-full">
      <mat-label>{{ "transaction.date" | translate }}</mat-label>
      <input
        placeholder="{{ 'transaction.date-placeholder' | translate }} "
        matInput
        [matDatepicker]="picker"
        formControlName="date"
      />
      <mat-datepicker-toggle
        matIconSuffix
        [for]="picker"
      ></mat-datepicker-toggle>
      <mat-datepicker #picker></mat-datepicker>
    </mat-form-field>
  </div>

  <!-- Row 2: Amount & Currency -->
  <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
    <mat-form-field appearance="outline" class="w-full">
      <mat-label>{{ "transaction.amount" | translate }}</mat-label>
      <input
        matInput
        type="number"
        formControlName="amount"
        placeholder="{{ 'transaction.amount-placeholder' | translate }} "
      />
    </mat-form-field>

    <mat-form-field appearance="outline" class="w-full">
      <mat-label>{{ "transaction.currency" | translate }}</mat-label>
      <mat-select
        formControlName="currency"
        placeholder="{{ 'transaction.currency-placeholder' | translate }} "
      >
        @for (opt of currencyList(); track $index) {
          <mat-option [value]="opt.value">{{ opt.label }}</mat-option>
        }
      </mat-select>
    </mat-form-field>
  </div>

  <!-- Row 3: Type & Category -->
  <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
    <mat-form-field appearance="outline" class="w-full">
      <mat-label>{{ "transaction.type" | translate }}</mat-label>
      <mat-select
        formControlName="type"
        placeholder="{{ 'transaction.type-placeholder' | translate }} "
      >
        @for (opt of transactionTypeList(); track $index) {
          <mat-option [value]="opt.value">{{ opt.label }}</mat-option>
        }
      </mat-select>
    </mat-form-field>

    <mat-form-field appearance="outline" class="w-full">
      <mat-label>{{ "transaction.category" | translate }}</mat-label>
      <mat-select formControlName="category">
        @for (opt of categoryList(); track $index) {
          <mat-option [value]="opt.value">{{ opt.label }}</mat-option>
        }
      </mat-select>
    </mat-form-field>
  </div>

  <!-- Row 4: Account & ToAccount (Conditional) -->
  <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
    <mat-form-field appearance="outline" class="w-full">
      <mat-label>{{ "transaction.account" | translate }}</mat-label>
      <mat-select
        formControlName="account"
        placeholder="{{ 'transaction.account-placeholder' | translate }} "
      >
        @for (opt of accountList(); track $index) {
          <mat-option [value]="opt.value">{{ opt.label }}</mat-option>
        }
      </mat-select>
    </mat-form-field>

    @if (form.get("type")?.value === TRANSACTION_TYPE_TRANSFER_ID()) {
      <mat-form-field appearance="outline" class="w-full">
        <mat-label>{{ "transaction.to-account" | translate }}</mat-label>
        <mat-select
          formControlName="toAccount"
          placeholder="{{ 'transaction.to-account-placeholder' | translate }} "
        >
          @for (opt of accountList(); track $index) {
            <mat-option [value]="opt.value">{{ opt.label }}</mat-option>
          }
        </mat-select>
      </mat-form-field>
    }
  </div>

  <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
    <mat-form-field appearance="outline" class="w-full">
      <mat-label>{{ "transaction.detrazione" | translate }}</mat-label>
      <mat-select formControlName="detrazione">
        <mat-option [value]="null">{{ "common.none" | translate }}</mat-option>
        @for (opt of detrazioneList(); track $index) {
          <mat-option [value]="opt.value">{{ opt.label }}</mat-option>
        }
      </mat-select>
    </mat-form-field>
  </div>

  <div class="flex flex-col md:flex-row justify-end gap-2 mt-4">
    <button
      mat-raised-button
      color="primary"
      type="submit"
      [disabled]="form.invalid"
      class="w-full md:w-auto"
    >
      {{ "common.save" | translate }}
    </button>
  </div>
</form>
